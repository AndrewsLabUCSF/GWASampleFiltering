---
title: "GWAS QC: Heterozygosity"
author: "Shea Andrews"
date: "`r Sys.Date()`"
output: html_document
editor_options:
  chunk_output_type: console
params:
    path.irem.fail: '~/Dropbox/Research/PostDoc-MSSM/3_mitoWAX/2_DerivedData/ADNI_2/ADNI2_02.irem'
    path.het.fail: '~/Dropbox/Research/PostDoc-MSSM/3_mitoWAX/2_DerivedData/ADNI_2/ADNI2_exclude.heterozigosity'
    path.sex.fail: '~/Dropbox/Research/PostDoc-MSSM/3_mitoWAX/2_DerivedData/ADNI_2/ADNI2_exclude.sexcheck'
    path.pca.fail: '~/Dropbox/Research/PostDoc-MSSM/3_mitoWAX/2_DerivedData/ADNI_2/ADNI2_exclude.pca'
    path.rel.fail: '~/Dropbox/Research/PostDoc-MSSM/3_mitoWAX/2_DerivedData/ADNI_2/ADNI2_exclude.relatedness'
    cohort: 'ADNI 2'
---

##  Samples Excluded

```{r setup sample QC, echo=F, warning=F, message=F}
##  ---- Load packages  ---- ##

library(tidyverse)

```


```{r read in sample exclusion files, echo=F, warning=F, message=F}

##  ---- Read in sample exclusion files files ---- ##
irem.raw <- read_tsv(params$path.irem.fail, col_names = F)
het.raw <- read_tsv(params$path.het.fail, col_names = T)
sex.raw <- read_tsv(params$path.sex.fail, col_names = T)
pca.raw <- read_tsv(params$path.pca.fail, col_names = F)
rel.raw <- read_tsv(params$path.rel.fail, col_names = T)

```

```{r wrangle sample exlusion files, echo=F, warning=F, message=F}

##  ---- Data wrangling ---- ##

irem <- irem.raw %>%
  rename(FID = X1, IID = X2) %>%
  mutate(call.rate = 'Fail')

het <- het.raw %>%
  mutate(Heterozygosity = 'Fail')

sex <- sex.raw %>%
  mutate(Sex = 'Fail')

pca <- pca.raw %>%
  rename(FID = X1, IID = X2) %>%
  mutate(PCA = 'Fail')

rel <- rel.raw %>%
  mutate(Relatedness = 'Fail')

excluded <- het %>%
  full_join(irem, by = c('FID', 'IID')) %>%
  full_join(sex, by = c('FID', 'IID')) %>%
  full_join(pca, by = c('FID', 'IID')) %>%
  full_join(rel, by = c('FID', 'IID'))

```


A total of `r nrow(excluded)` samples were flaged (Table 1) for exclusion after sample QC. `r nrow(het)` samples were excluded due to outlying heterozygocity, `r nrow(irem)` samples were excluded due to low call rate, `r nrow(sex)` samples were excluded due to discordant sex information, `r nrow(rel)` samples were excluded due to cryptic relatedness, and `r nrow(pca)` samples were excluded due to divergent genetic ancestry.
<br>

***Table 1:*** Samples excluded by GWAS quality control procedures.
```{r print exluded sample table, echo = F}
as.data.frame(excluded)
```
