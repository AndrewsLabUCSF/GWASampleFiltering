---
date: "`r Sys.Date()`"
editor_options:
  chunk_output_type: console
output:
  bookdown::html_document2:
    base_format: rmarkdown::html_document
    keep_md: yes
    fig_caption: TRUE
    split_by: none
    self_contained: yes
    theme: flatly
    df_print: paged
    toc: true
    #number_sections: true
    toc_depth: 4
    toc_float:
      collapsed: false
      smooth_scroll: false
params:
    rmd: "GWAS_QC.Rmd"
title: "Genomic Sample QC Report"
author: "Written and maintained by Brian Fulton-Howard and Shea Andrews"
---

## Sample QC for `r snakemake@wildcards[["sample"]]`

Pipeline version `r snakemake@params[["pipeline_version"]]`


```{r setup, include=FALSE, echo=F, message=F, warning=F}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = snakemake@params[["rwd"]])
cr_tf <- (snakemake@input[["imiss"]] != "/dev/null" ||
          snakemake@input[["frq"]] != "/dev/null")
sexcheck_tf <- snakemake@input[["SexFile"]] != "/dev/null"
hetcheck_tf <- snakemake@input[["HetFile"]] != "/dev/null"
relcheck_tf <- snakemake@input[["IBD_stats"]] != "/dev/null"
pcacheck_tf <- snakemake@input[["PCA_rdat"]] != "/dev/null"
strat_tf <- snakemake@input[["PopStrat_eigenvec"]] != "/dev/null"
sdir <- function(x) sprintf("%s/%s", snakemake@scriptdir, x)
```

```{r child = sdir('call_rates.Rmd'), eval = cr_tf}
```

```{r child = sdir('sexcheck_QC.Rmd'), eval = sexcheck_tf}
```

```{r child = sdir('Heterozygosity_QC.Rmd'), eval = hetcheck_tf}
```

# Population and family structure

```{r child = sdir('relatedness_QC.Rmd'), eval = relcheck_tf}
```

```{r child = sdir('PCA_QC.Rmd'), eval = pcacheck_tf}
```

```{r child = sdir('population_stratification_QC.Rmd'), eval = strat_tf}
```
